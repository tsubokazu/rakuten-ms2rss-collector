# RSS関数リファレンス

## 注文関数

### 1. RssStockOrder - 国内株式現物注文

指定した国内株式銘柄について、注文区分ごとに現物注文を実行します。

**構文:**
```excel
=RssStockOrder(発注ID,発注トリガー,銘柄コード,売買区分,注文区分,SOR区分,注文数量,価格区分,注文価格,執行条件,注文期限,口座区分,逆指値条件価格,逆指値条件区分,逆指値価格区分,逆指値価格,セット注文区分,セット注文価格,セット注文執行条件,セット注文期限)
```

**主要パラメータ:**
- **発注ID**: 1以上の数値（注文を一意に識別）
- **発注トリガー**: 0（待機）/ 1（発注）
- **銘柄コード**: 「銘柄コード.市場」形式（例：7203.T）
- **売買区分**: 1（売り）/ 3（買い）
- **注文区分**: 0（通常）/ 1（逆指値付）/ 2（逆指値待機）
- **SOR区分**: 0（通常）/ 1（SOR注文）

### 2. RssMarginOpenOrder - 信用新規注文

信用取引の新規建玉注文を実行します。

**追加パラメータ:**
- **信用区分**: 1（制度6ヶ月）/ 2（一般無制限）/ 3（一般14日）/ 4（一般1日）

### 3. RssMarginCloseOrder - 信用返済注文

既存の信用建玉に対する返済注文を実行します。

**追加パラメータ:**
- **建日**: 返済対象建玉の建日（YYYYMMDD）
- **建単価**: 返済対象建玉の建単価
- **建市場**: 1（東証）/ 4（JNX）/ 5（JAX）/ 6（Chi-X）

## 注文約定関数

### 1. RssOrderList - 国内株式注文一覧

国内株式の注文状況一覧を表示します。

**構文:**
```excel
=RssOrderList(ヘッダー行,注文状況,注文種類,銘柄コード,口座区分,売買,信用取引,信用区分,アルゴ注文,アルゴ注文種類)
```

**戻り値項目:**
- 注文番号、受付No、注文状況
- 銘柄コード、銘柄名称、市場名称
- 発注/受注日時、売買区分、取引種類
- 注文数量、約定数量、注文単価

### 2. RssPositionList - 保有銘柄一覧

現物保有銘柄の一覧を表示します。

**戻り値項目:**
- 保有数量、発注数量、平均取得価額
- 時価、前日比、前日比率
- 時価評価額、評価損益額、評価損益率
- PER、PBR、配当利回り

## 投資情報関数

### 1. RssMarket - 市況情報（国内株式）

指定した国内株式の市況情報を取得します。

**構文:**
```excel
=RssMarket("銘柄コード","取得項目")
```

**取得可能項目例:**
- 現在値、前日比、前日比率
- 始値、高値、安値
- 出来高、売買代金
- 最良売気配、最良買気配

### 2. RssIndexMarket - 市況情報（指標）

各種指標の市況情報を取得します。

**対応指標例:**
- 日経平均株価
- TOPIX
- 業種別指数
- その他各種指標

### 3. RssFXMarket - 市況情報（為替レート）

為替レートの市況情報を取得します。

## チャート関数

### 1. RssChart - チャート情報

指定した銘柄のチャート情報を表示します。

**構文:**
```excel
=RssChart(ヘッダー行,銘柄コード,足種,表示本数)
```

**対応足種:**
- **短期**: T（ティック）、1M-60M（分足）
- **中期**: 2H-8H（時間足）
- **長期**: D（日足）、W（週足）、M（月足）

### 2. RssTrendSMA - 単純移動平均線

指定した銘柄の単純移動平均線情報を表示します。

**構文:**
```excel
=RssTrendSMA(ヘッダー行,銘柄コード,足種,表示本数,期間1,期間2,期間3,期間4,期間5,期間6,期間7)
```

**期間設定:**
- 最大7本まで同時表示可能
- 期間1は必須、期間2-7は任意

## 先物・オプション関数

### 1. RssFOPOpenOrder - 先物OP新規注文

先物・オプションの新規注文を実行します。

**追加パラメータ:**
- **執行数量条件**: 1（FOK）/ 2（FAK）/ 3（FAS）
- **執行時間条件**: 1（当セッション）/ 4（引け）/ 5（期間指定）/ 9（取引最終日）

### 2. RssFOPCode - 先物OP銘柄コード取得

先物・オプションの銘柄コードを取得します。

**構文:**
```excel
=RssFOPCode(銘柄種類,限月,C/P区分,行使価格)
```

## エラー処理

### 注文関数の戻り値

1. **発注ID=xxxx は既に使用済みです** - 重複ID使用時
2. **待機中** - 発注トリガーがFalse状態
3. **発注ロック中** - 発注機能がOFF状態
4. **接続待ち** - サーバ未接続状態
5. **応答待ち** - 電文応答待ち状態
6. **発注済み(発注ID=xxxx)** - 発注完了時
7. **入力エラー** - 引数チェックエラー
8. **サーバチェックエラー** - サーバ側エラー

## 制限事項

- **表示本数制限**: チャート関数は最大3000本
- **VBA関数**: 一部関数で引数数に制限あり
- **SOR注文**: 寄付・引け注文では利用不可
- **市場時間**: 立会時間外では一部機能制限

## セキュリティ注意事項

- 発注IDは適切に管理すること
- 本番環境での自動売買は十分なテストを実施すること
- 市場急変時の対応策を事前に準備すること